# Excel 数据可视化工具

一个功能强大的 Excel 数据可视化网页应用，支持数据聚合、透视表功能、多种图表类型和图片导出。

## 功能特性

- ✅ **Excel 文件上传**: 支持 .xlsx 和 .xls 格式
- ✅ **数据透视表**: 类似 Excel 的透视表功能，支持多种聚合方式
- ✅ **多种图表类型**: 柱状图、折线图、面积图、饼图、散点图
- ✅ **数据轴自定义**: 自由配置 X 轴和 Y 轴数据
- ✅ **日期列处理**: 自动识别日期列，支持按天/月/年分组
- ✅ **数值列聚合**: 支持求和、平均值、计数、最大值、最小值
- ✅ **图片导出**: 将生成的图表保存为 PNG 图片
- ✅ **数据预览**: 查看上传的 Excel 数据

## 技术栈

- React 18
- Vite
- Recharts (图表库)
- xlsx (Excel 解析)
- html2canvas (图片导出)
- Tailwind CSS (样式)
- react-dropzone (文件上传)
- lucide-react (图标)

## 安装和运行

### 1. 安装依赖

```bash
npm install
```

### 2. 启动开发服务器

```bash
npm run dev
```

应用将在 `http://localhost:5173` 打开。

### 3. 构建生产版本

```bash
npm run build
```

### 4. 预览生产版本

```bash
npm run preview
```

## 使用说明

### 1. 上传 Excel 文件
- 点击上传区域或拖拽 Excel 文件到页面
- 支持的格式: .xlsx, .xls
- 项目根目录包含示例文件 `sample-data.xlsx` 可供测试

### 2. 配置图表
- **图表类型**: 选择柱状图、折线图、面积图、饼图或散点图
- **分组维度 (X轴)**: 选择用于分组的列（文本或日期列）
- **聚合指标 (Y轴)**: 选择数值列进行聚合
- **聚合方式**: 选择求和、平均值、计数、最大值或最小值
- **日期分组方式**: 如果 X 轴选择日期列，可按天/月/年分组

### 3. 查看图表
- 图表会根据配置实时更新
- 支持响应式布局，适配不同屏幕尺寸

### 4. 导出图片
- 点击"保存图片"按钮将图表导出为 PNG 格式

### 5. 数据预览
- 页面底部显示原始数据预览
- 自动检测每列的数据类型（日期、数值、文本）

## 示例数据

项目包含一个示例 Excel 文件 `sample-data.xlsx`，包含以下列：
- 日期: 销售日期
- 产品名称: 产品类别
- 销售量: 销售数量（数值）
- 销售额: 销售金额（数值）
- 地区: 销售地区

## 项目结构

```
excel-chart-app/
├── src/
│   ├── components/
│   │   ├── FileUpload.jsx       # 文件上传组件
│   │   ├── PivotTableConfig.jsx # 图表配置组件
│   │   └── ChartDisplay.jsx     # 图表显示组件
│   ├── utils/
│   │   └── excelUtils.js        # Excel 处理工具函数
│   ├── App.jsx                  # 主应用组件
│   ├── index.css                # 全局样式
│   └── main.jsx                 # 应用入口
├── sample-data.xlsx             # 示例数据
└── package.json
```

## 核心功能实现

### 数据聚合 (`excelUtils.js`)

- `groupAndAggregate()`: 按指定列分组并聚合数据
- `aggregateByDate()`: 按日期分组并聚合数据（支持日/月/年级别）
- `detectColumnType()`: 自动检测列的数据类型
- `parseExcel()`: 解析 Excel 文件为 JSON 数据

### 图表类型

1. **柱状图**: 适合比较不同类别的数值
2. **折线图**: 适合显示数据随时间的变化趋势
3. **面积图**: 类似折线图，但填充区域以强调数值
4. **饼图**: 显示各部分占总体的比例
5. **散点图**: 显示两个数值变量之间的关系

## 浏览器支持

- Chrome (推荐)
- Firefox
- Safari
- Edge

## 许可证

MIT

## 贡献

欢迎提交 Issue 和 Pull Request！
